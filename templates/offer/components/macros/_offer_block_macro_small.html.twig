{% macro createIcon(title, path, iconClass) %}
    <a title="{{ title }}" href="{{ path }}" class=""><i class="material-symbols-outlined">{{ iconClass }}</i></a>
{% endmacro %}
{% macro getArray(offer) %}
    {{ _self.createIcon('Service', path('offer_edit_plus', {'id': offer.id}), 'design_services') }}
    {% set statusIcons = {
        'call': {
            'status': 1,
            'icon': _self.createIcon('Kunden anrufen', path('offer_edit', {'id': offer.id}), 'support_agent')
        },
        'call-plus': {
            'status': 0,
            'icon': _self.createIcon('Kundenformular aufrufen', path('offer_edit', {'id': offer.id}), 'edit')
        },
        'estimate': {
            'status': 1.1,
            'icon': _self.createIcon('Kostenvoranschlag', path('offer_show', {'id': offer.id}), 'local_offer')
        },
        'besichtigung': {
            'status': 1.2,
            'icon': _self.createIcon('Kostenvoranschlag', path('offer_show', {'id': offer.id}), 'local_offer')
        },
        'open': {
            'status': 2,
            'icon': _self.createIcon('Angebot bearbeiten und senden', path('offer_show', {'id': offer.id}), 'content_paste')
        },
        'gesendet': {
            'status': 3,
            'icon': _self.createIcon(offer.order ? 'o.sendAt'|trans({'%date%': offer.order.createdAt|date('d.m.Y')}) : 'Fehler '~ offer.id, path('offer_show', {'id': offer.id}), 'content_paste'),
            'allow': 'bestaetigt',
            'sendDate': offer.order ? offer.order.createdAt|date('d.m.Y') : null
        },
        'storno': {
            'status': 0,
            'icon': _self.createIcon('', path('offer_show', {'id': offer.id}), 'content_paste'),
            'allow': 'all'
        },
        'bestaetigt': {
            'status': 4,
            'icon': (offer.id == null or offer.order == null) ? '<br><i class="material-symbols-outlined">warning</i> Angebot NICHT gesendet/gespeichert!' :
            _self.createIcon('o.sendAt'|trans({'%date%': offer.order.createdAt|date('d.m.Y')}), path('offer_show', {'id': offer.id}), 'content_paste') ~ '
            ' ~ _self.createIcon('', path('invoice_part_index', {'id': offer.order.id}), 'receipt_long')
        },
        'rechnungPartSend': {
            'status': 5,
            'icon': _self.createIcon('o.sendAt'|trans({'%date%': offer.order.createdAt|date('d.m.Y')}), path('offer_show', {'id': offer.id}), 'content_paste') ~ '
        ' ~ _self.createIcon('o.sendAt'|trans({'%date%': offer.order.invoices[0].sendDate|date('d.m.Y')}), path('invoice_part_index', {'id': offer.order.id}), 'receipt_long'),
            'allow': 'rechnungPartEingang',
            'sendDate': offer.order.invoices[0].sendDate|date('d.m.Y')
        },
        'rechnungPartEingang': {
            'status': 6,
            'icon': _self.createIcon('o.sendAt'|trans({'%date%': offer.order.createdAt|date('d.m.Y')}), path('offer_show', {'id': offer.id}), 'content_paste') ~ '
        '~ _self.createIcon('o.sendAt'|trans({'%date%': offer.order.invoices[0].sendDate|date('d.m.Y')}), path('invoice_part_index', {'id': offer.order.id}), 'receipt_long') ~ '
        '~ _self.createIcon('title.product.index'|trans, path('sf_montage_offer', {'id': offer.id,'a':true}), 'inventory'),
            'allow': 'work',
        },
        'work': {
            'status': 7,
            'icon': _self.createIcon('o.sendAt'|trans({'%date%':offer.order.createdAt|date('d.m.Y')}), path('offer_show', {'id': offer.id}), 'content_paste') ~ '
        '~ _self.createIcon('o.sendAt'|trans({'%date%':offer.order.invoices[0].sendDate|date('d.m.Y')}), path('invoice_part_index', {'id': offer.order.id}), 'receipt_long'),
            'allow': 'done',
        },
        'done': {
            'status': 8,
            'icon': _self.createIcon('o.sendAt'|trans({'%date%':offer.order.createdAt|date('d.m.Y')}), path('offer_show', {'id': offer.id}), 'content_paste') ~ '
        '~ _self.createIcon('o.sendAt'|trans({'%date%':offer.order.invoices[0].sendDate|date('d.m.Y')}), path('invoice_part_index', {'id': offer.order.id}), 'receipt_long') ~ '
        '~ _self.createIcon('Schlussrechnung', path('invoice_rest_index', {'id': offer.id}), 'receipt'),
        },
        'rechnungEingangSend': {
            'status': 9,
            'icon': _self.createIcon('o.sendAt'|trans({'%date%':offer.order.createdAt|date('d.m.Y')}), path('offer_show', {'id': offer.id}), 'content_paste') ~ '
        '~ _self.createIcon('o.sendAt'|trans({'%date%':offer.order.invoices[0].sendDate|date('d.m.Y')}), path('invoice_part_index', {'id': offer.order.id}), 'receipt_long') ~ '
        '~ _self.createIcon('title.product.index'|trans, path('backend_material_index', {'offerNumberBasic': offer.number}), 'production_quantity_limits') ~ '
        '~ _self.createIcon('Schlussrechnung', path('invoice_rest_index', {'id': offer.id}), 'receipt'),
            'allow': 'rechnungEingang',
            'sendDate': offer.order.invoices[(offer.order.invoices|length-1)].sendDate|date('d.m.Y')
        },
        'rechnungEingang': {
            'status': 10,
            'icon': _self.createIcon('o.sendAt'|trans({'%date%':offer.order.createdAt|date('d.m.Y')}), path('offer_show', {'id': offer.id}), 'content_paste') ~ '
        '~ _self.createIcon('o.sendAt'|trans({'%date%':offer.order.invoices[0].sendDate|date('d.m.Y')}), path('invoice_part_index', {'id': offer.order.id}), 'receipt_long') ~ '
        '~ _self.createIcon('title.product.index'|trans, path('backend_material_index', {'offerNumberBasic': offer.number}), 'production_quantity_limits') ~ '
        '~ _self.createIcon('Schlussrechnung', path('invoice_rest_index', {'id': offer.id}), 'receipt')
        },
        'archive': {
            'status': 11,
            'icon': _self.createIcon('o.sendAt'|trans({'%date%':offer.order.createdAt|date('d.m.Y')}), path('offer_show', {'id': offer.id}), 'content_paste') ~ '
        '~ _self.createIcon('o.sendAt'|trans({'%date%':offer.order.invoices[0].sendDate|date('d.m.Y')}), path('invoice_part_index', {'id': offer.order.id}), 'receipt_long') ~ '
        '~ _self.createIcon('title.product.index'|trans, path('backend_material_index', {'offerNumberBasic': offer.number}), 'production_quantity_limits') ~ '
        '~ _self.createIcon('Schlussrechnung', path('invoice_rest_index', {'id': offer.id}), 'receipt')
        },
    } %}
-%}
{% endmacro %}

{% macro getStatus(value) %}
    {% if value is not null -%}
        {{ value|number_format(0, '', '') }}
    {%- else -%}
        0
    {%- endif %}
{% endmacro %}
{% macro getIcons(status, value) %}
    {%- set icon = value[status]['icon']|default('') -%}
    {{ icon }}
{% endmacro %}

{% macro offerBlockSmall(offer, users, teams, sfColor, sfColorDark, ActionLog,form2) %}
{#    {% set allow = '' %}#}
{#    {% set icon = '' %}#}
{#    {% set sendDate = '' %}#}
    {% if offer.inquiry and offer.status != 'deleted' %}
        {% set lateDatum = 'now'|date_modify('-8 days')|date('ymd') %}
        {% set importDatum = offer.inquiry ? offer.inquiry.date|date('ymd') : offer.offerDate|date('ymd') %}
        {% set importDatumDate = offer.inquiry ? offer.inquiry.date|date('d.m.Y') : offer.offerDate|date('d.m.Y') %}
        {% set datum = offer.order ? offer.order.createdAt|date('d.m') : offer.offerDate|date('d.m') %}
        {% set difference = date('now'|date('Y-m-d H:i:s')).diff(date(offer.inquiry.date|date('Y-m-d H:i:s'))) %}
        {% set leftDays = difference.days %}
        {% set hasTermine = offer.bookings|length %}
        {%- set value = _self.getArray(offer)[offer.status]['status']|default(0) -%}
        {% set status = _self.getStatus(offer.status, value) %}
        {% set icon = _self.getIcons(offer.status, value) %}
        {% set allow = value[offer.status]['allow']|default(null) %}
        {% set sendDate = value[offer.status]['sendDate']|default(null) %}
{#        {{ save('status') }}#}
{#        {{ save('icon') }}#}
{#        {% include 'offer/_offer_block_status.html.twig' with {'status': offer.status } %}#}
{#        {{ restore('status') }}#}
{#        {{ restore('icon') }}#}
        {% set called = false %}
        {% set booking_k = '' %}
        {% set booking_g = '' %}
        {% set booking_s = '' %}
        {% set wp_block = '' %}
        {% if offer.wallboxProduct %}
            {% set wp_block = '<span title="' ~ offer.wallboxProduct.name ~ '" class="sf_bing product_block">' ~ offer.wallboxProduct.fullName ~ ' (Anz.:' ~ offer.amount ~ ')</span>' %}
        {% endif %}

        {% set calledA = false %}
        {% set statusClasses = {
            'call': 'status-call',
            'call-plus': 'status-call-plus',
            'open': 'status-open',
            'gesendet': 'status-gesendet',
            'archive': 'status-archive'
        } %}

{#   bookings code entfehrnt    #}

        {% if booking_g != '' or called %}
            {% set booking_s = booking_g %}
        {% else %}
            {% set booking_s = booking_k %}
        {% endif %}

        {% set color = sfColor %}
        {% set classNAme = calledA ? 'box_name_color' : 'box_name_color_active' %}

    {#    <div data-controller="update-offer" data-update-offer-offer-id-value="{{ offer.id }}" data-update-offer-update-url-value="{{ path('ajax_update_offer_status', {'id':offer.id}) }}"
             data-update-offer-target="element" class="data_block">

            {% set greenbg = 'background-color:#efefef;color:#000;' %}
            {% set greybg = 'background-color:grey;' %}
            {% set sendbg = 'background-color:#c5554d' %}
            {% set yellowbg = 'background: repeating-linear-gradient( 135deg, #ffc500, #ffc500 10px, ' ~ sfColorDark ~ ' 10px, ' ~ sfColor ~ ' 20px );' %}



            <div data-list-target="item"
                 {% if offer.order %}data-order="{{ offer.order.id }}"{% endif %}
                 data-offer="{{ offer.id }}"
                 data-allow="{{ allow }}"
                 data-from="{{ status }}"
                 id="customer_j_{{ offer.id }}"
                 class="offer_box{% if calledA %} active_box active_but_icon{% endif %}{% if hasTermine %} terminati{% endif %} offers_numbers offer_number{{ offer.customer.customerNumber }} card-box card"
                 style="width: 100%;{% if status == 7 %}margin-top: 0;border-top: none;border-radius: 0 0 6px 6px;{% endif %}{{ statusClasses[offer.status]|default('') }}">

                {% if is_granted('ROLE_EMPLOYEE_EXTERN') %}
                    <div id="warner-{{ offer.id }}-delete" class="warner-{{ offer.id }} warner_delete warner {% if offer.deleteIt == false %}d-none{% endif %}" style="z-index: 99">
                        <img src="{{ asset('app/images/noOk.svg') }}">
                    </div>
                    <div id="warner-{{ offer.id }}-urgent" class="warner-{{ offer.id }} warner_urgent warner {% if offer.urgent == false or offer.deleteIt != false %}d-none{% endif %}">
                        <img style="width: 20px;left: -8px;top: 11px;" src="{{ asset('app/images/call.svg') }}">
                    </div>
                {% endif %}
                <h4 style="font-size: 1rem" {{ stimulus_controller('offer', {offerId: offer.id, offerNumber: offer.number}) }}>
                    #}{# Angebots SubCategory #}{#
                    <div class="w-100 offer_plus_box_block" {% if called %}style="color: {{ sfColorText }};"{% endif %}><span style="font-size: 14px;">{{ getOfferTitle(offer.id, true, true)|raw -}}</span>
                        {% if offer.customer.companyName %}
                            <br><span class="customer_user_box_address">{{ offer.stationAddress }} {{ offer.stationZip }}</span>
                        {% endif %}
                    </div>
                    #}{# Angebots Nummer #}{#
                    <div class="offer_number_box w-25">
                        <button data-offer="{{ offer.id }}" class="box-button text pointer_number" style="display:flex;" {{ stimulus_action('offer', 'viewBox') }}>
                            {{ offer.number }}
                        </button>
                        {% if app.user.id != offer.user.id and (app.request.query.get('user', 'all') == 'all' or app.request.query.get('search', '') != '') %}
                            <span{% if called %} style="color: {{ sfColorText }};"{% endif %}>&nbsp;{{ offer.user.username }}</span>
                        {% endif %}
                    </div>
                    {% set foo = offer.number|split('.') %}
                    {% set cal = offer.customer.offers|length %}
                    <div class="active_link w-100 small text-right {{ classNAme }}">
                        #}{# Profil Link #}{#
                        {% if is_granted('ROLE_EMPLOYEE_EXTERN') %}
                            <a href="{{ path('customer_edit', {'id': offer.customer.id}) }}" class="w-100 {{ classNAme }}" style="font-weight: normal;font-size: 0.9rem">{{ offer.customer.fullNormalName }}</a>
                        {% else %}
                            <p class="w-100 {{ classNAme }}">{{ offer.customer.fullNormalName }}</p>
                        {% endif %}
                        {% if offer.customer.companyName %}
                            <p class="w-100 clearfix m-0">{{ offer.customer.companyName }}</p>
                        {% endif %}
                        #}{# Anzahl Angebote Kreis #}{#
                        {% if cal > 1 and is_granted('ROLE_EMPLOYEE_EXTERN')%}
                            <a href="{{ path('offer_category_isearch') }}?search={{ foo[0] }}" class="red_dot offer_dot{% if called %} offer_dot_call{% endif %}" style=""><span style="color: #fff;">{{ cal }}</span></a>
                        {% endif %}
                    </div>
                </h4>

                {{ booking_s|raw }}
                {{ wp_block|raw }}
                <div class="row d-none text booking_row_block" id="non-kj{{ offer.id }}">
                    <div class="col-md-12" style="padding: 0 4px;background-color: #fff;">
                        <div class="small-9" style="color: {{ color }}">
                            {% if status > 1 %}
                                <div class="mb-2 header_text boxname text-center" style="{% if called %}color:#000;{% endif %}">{{ getOfferName(offer.id, false, true)|raw }}</div>
                            {% elseif status == 1 %}
                                <div class="header_text" style="padding-top: 6px;padding-bottom: 0">{{ 'iq.callCustomer'|trans }}!</div>
                            {% else %}
                                <div class="header_text" style="padding-top: 6px;padding-bottom: 0">{{ 'iq.inWork'|trans }}<br>{{ getOfferName(offer.id, false, true)|raw }}</div>
                            {% endif %}
                        </div>
                        {% if offer.id %}
                            <div id="froBi{{ offer.id }}" class="pin_links_box" style="border-top: 1px solid {{ color }};border-bottom: 1px solid {{ color }}">
                                <div style="float: left; padding-top: 6px;">
                                    {% if is_granted('ROLE_EMPLOYEE_EXTERN') %}
                                        <a class="pl-2"
                                           title="E-Mail an den Kunden"
                                           data-action="click->email#launchEmail"
                                           type="button"
                                           data-type="default"
                                           data-email-src-param="{{ path('ajax_create_default_mail',{'id':offer.customer.id,'template':'default'}) }}"
                                           data-email-url-param="{{ path('ajax_load_detail_mail',{'id':offer.customer.id,'template':'default'}) }}"
                                           data-email-attachurl-param="{{ path('ajax_attachments_mail',{'id':offer.id,}) }}"
                                           data-id="{{ offer.customer.id }}"
                                           data-offer="{{ offer.id }}"
                                           data-name="{{ offer.customer.fullNormalName }} ({{ offer.customer.email }})"
                                           data-title="{{ 'message.new'|trans }}" style="cursor: pointer"><small>
                                                <i class="material-symbols-outlined">email</i></small>
                                        </a>
                                    {% endif %}
                                    {% if status > 3 %}
                                        <a title="Material" class="ml-0 pl-0" target="_self" href="{{ path('backend_material_index', {'offerNumberBasic':offer.number}) }}"><span class="material-symbols-outlined">production_quantity_limits</span></a>
                                    {% endif %}
                                    {% if is_granted('ROLE_EMPLOYEE_EXTERN') %}
                                        <a title="Kundenprofil Ansicht" class="ml-0 pl-0" target="_blank" href="{{ path('public_index', {'user':offer.customer.id}) }}"><span style="margin: -8px 0 0 0;" class="material-icons">emoji_people</span></a>

                                        {% if offer.status != 'call' %}
                                            <a title="{{ 'w.copy'|trans }}" href="javascript:" class="copyButton"><span class="material-symbols-outlined">content_copy</span></a>
                                        {% endif %}
                                    {% endif %}
                                </div>
                                <div style="float: right; text-align: right;padding-right: 20px; padding-top: 6px;">
                                    <a href="{{ path('offer_auftrags_index', {'id': offer.id, 'a':2}) }}"><span class="material-symbols-outlined">pending_actions</span></a>
                                    {{ icon|raw }}
                                </div>
                            </div>
                            <div id="froBi{{ offer.id }}open" class="pin_links_box collapseI d-none" style="border-bottom: 1px solid {{ color }}">
                                <div style="text-align:center;padding-top: 6px;">
                                    {% if offer.status != 'call' %}
                                        <a  class="btn btn-sm btn-light" title="{{ 'w.copy'|trans }}" href="{{ path('inquiry_copy', {'id': offer.inquiry.id, 'data':true}) }}">{{ 'o.copy.include'|trans }}</a>
                                        <a class="btn btn-sm btn-light" title="{{ 'w.copy'|trans }}" href="{{ path('inquiry_copy', {'id': offer.inquiry.id, 'data':false}) }}">{{ 'o.copy.exclude'|trans }}</a>
                                    {% endif %}
                                </div>
                            </div>
                        {% endif %}
                        {% include 'offer/components/_email_phone_block.html.twig' %}
                        <div class="block_box">
                            <p class="text-left pl-1 box_boxHeader m-0">{{ 'w.project'|trans }}</p>
                            <div class="row pl-1">
                                <div class="col-4"><small>{{ 'w.editor'|trans }}:</small></div>
                                <div class="col-8">
                                    <select{% if is_granted('ROLE_EMPLOYEE_EXTERN') == false %} disabled{% endif %} data-action="{{ path('ajax_update_offer_user', {'offer':offer.id,'user':'uuuu'}) }}"
                                                                                                                    data-id="{{ offer.id }}"
                                                                                                                    class="user_inquiry form-control block_box_input">
                                        {% for user in users %}
                                            {% if user.id != 1 %}
                                                {% if is_granted('ROLE_MONTAGE') %}
                                                    <option{% if offer.user is not null and user.id == offer.user.id %} selected{% endif %} value="{{ user.id }}">{{ user.username|capitalize }}</option>
                                                {% endif %}
                                            {% endif %}
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            {% if offer.subCategory %}
                                {% for tc in offer.subCategory.teamCategories %}
                                    <div class="row pl-1">
                                        <div class="col-4"><small>{{ tc.name }}:</small></div>
                                        <div class="col-8">
                                            <select{% if is_granted('ROLE_EMPLOYEE_EXTERN') == false %} disabled{% endif %} data-action="{{ path('ajax_update_offer_team', {'tc':tc.id,'offer':offer.id,'team':'uuuu'}) }}"
                                                                                                                            data-id="{{ offer.id }}"
                                                                                                                            class="user_inquiry form-control block_box_input">
                                                <option {% if offer.projectTeams|length == 0 %}selected {% endif %} value="0"></option>
                                                {% for team in teams %}
                                                    {% if team.category and team.category.id == tc.id %}
                                                        <option{% if offer.projectTeams|length > 0 and team in offer.projectTeams %} selected{% endif %}
                                                                value="{{ team.id }}">{{ team.name }}</option>
                                                    {% endif %}
                                                {% endfor %}
                                            </select>
                                        </div>
                                    </div>
                                {% endfor %}
                            {% endif %}
                            <div class="row pl-1">
                                <div class="col-4"><small>{{ 'w.projectManager'|trans }}:</small></div>
                                <div class="col-8">
                                    <select {% if is_granted('ROLE_EMPLOYEE_EXTERN') == false %} disabled{% endif %} data-action="{{ path('ajax_update_offer_monteur', {'offer':offer.id,'user':'uuuu'}) }}"
                                                                                                                     data-id="{{ offer.id }}"
                                                                                                                     class="user_inquiry form-control block_box_input">
                                        <option {% if offer.monteur is null %}selected {% endif %} value="0"></option>
                                        {% for user in getMontageUsers() %}
                                            <option{% if offer.monteur is not null and user.id == offer.monteur.id %} selected{% endif %}
                                                    value="{{ user.id }}">{{ user.username|capitalize }}</option>
                                        {% endfor %}
                                    </select>
                                </div>
                            </div>
                            <p class="text-left pl-1 box_boxFooter m-0">{{ 'o.lastChanges'|trans }}:
                                <span class="work_on">{% if offer.statusDate %}{{ offer.statusDate|date('d.m') }}{% endif %}</span>
                            </p>
                        </div>
                        {% if is_granted('ROLE_EMPLOYEE_EXTERN') %}
                            <div class="pt-1 pb-1" style="border-top: 1px solid #028281;border-bottom: 1px solid #028281;">
                                <div style="clear: left">
                                    <p class="m-0"><input aria-label="{{ 'o.deletePlease'|trans }}" {% if offer.deleteIt %}checked {% endif %}
                                                          type="checkbox"
                                                          data-action="{{ path('ajax_update_tp', {'offer':offer.id,'deleteIt':'cccc','type':'delete'}) }}"
                                                          data-id="{{ offer.id }}"
                                                          data-mclass="warner-{{ offer.id }}-delete"
                                                          class="u_b_icon user_delete"/> <span class="material-symbols-outlined">highlight_off</span> &nbsp;{{ 'o.deletePlease'|trans }}</p>

                                </div>
                                <div style="clear: left">
                                    <p class="m-0">
                                        <input {% if offer.urgent %}checked {% endif %}
                                               type="checkbox"
                                               data-action="{{ path('ajax_update_tp', {'offer':offer.id,'urgent':'cccc','type':'urgent'}) }}"
                                               data-id="{{ offer.id }}"
                                               data-mclass="warner-{{ offer.id }}-urgent"
                                               class="u_b_icon user_urgent"/> <span class="material-symbols-outlined">warning_amber</span>&nbsp;{{ 'o.urgentCall'|trans }}</p>

                                </div>
                            </div>
                        {% endif %}
                        <div class="block_box custom-select-button">
                            {% include 'offer/montage/components/_auftrags_notice.html.twig' with {'ActionLog':ActionLog, 'notes':offer.logs} %}
                        </div>
                        <small><strong>{{ 'w.appointments'|trans }}: </strong>
                            {% if is_granted('ROLE_EMPLOYEE_EXTERN') %}
                                <a style="position: relative;vertical-align: middle"
                                   href="javascript:void(0)" data-number="{{ offer.number }}"
                                   data-name="{{ offer.customer.fullName }}"
                                   data-action="{{ path('booking_new', {'offer':offer.id,'customer':offer.customer.id}) }}"
                                   class="booking_event" data-toggle="modal" data-target="#terminModal">
                                    <span style="color: {{ sfColorDark }};position: relative;vertical-align: middle" class="material-symbols-outlined">add_circle</span>
                                </a>
                            {% endif %}
                        </small>
                        {% include 'offer/_offer_next_status_button.html.twig' with {'offer': offer} %}
                    </div>
                </div>
                {% set statusNumber = getStatusNumber(offer.status) %}
                {% if statusNumber == 5 and offer.order is not null and offer.order.createdAt is not null %}
                    <div class="customer_bottom_block" style="background-color: #fff;">
                        <table class="table" style="font-size: 0.7rem">
                            <tr>
                                <th class="info_th" style="">Angebot gesendet</th>
                                <th class="info_th">Vergangen</th>
                                <th class="info_th"></th>
                            </tr>
                            <tr style="background-color: #fdfeec;">
                                <td>{{ offer.order.createdAt|date('d.m.Y H:i') }}</td>
                                <td>{{ offer.order.createdAt|ago }}</td>
                                <td></td>
                            </tr>
                        </table>
                    </div>
                {% elseif statusNumber >= 7 and is_granted('ROLE_EMPLOYEE_EXTERN') %}
                    <div class="customer_bottom_block" style="background-color: #fff;">
                        <table class="table invoice_table" style="font-size: 0.7rem">
                            <tr>
                                <th class="info_th">Rechnung</th>
                                <th class="info_th">Gesendet</th>
                                <th class="info_th">Vergangen</th>
                                <th class="info_th">Bezahlt</th>
                                <th class="info_th"></th>
                            </tr>
                            #}{# 'bestaetigt' => 6, 'rechnungPartSend' => 7, #}{#
                            {% set iti = {'part':'Abschlag', 'part-plus':'TeilR.', 'rest':'SchlussR.'} %}
                            {% set invoiceType = 1 %}
                            {% include 'offer/invoice_block_in_box.html.twig' with {'invoices':offer.order.invoices} %}
                        </table>
                    </div>
                {% endif %}
            </div>
        </div>
    #}{% endif %}
{% endmacro %}